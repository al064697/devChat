<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SocketIO & Python - Chat con Salas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container mt-4">
        <h1 class="text-center mb-4">devChat</h1>

        <!-- Grupo de entrada para el nombre de usuario -->
        <div class="input-group mb-3">
            <input type="text" id="username" class="form-control" placeholder="Tu nombre de usuario">
            <button id="setUsername" class="btn btn-success">Establecer</button>
        </div>

        <!-- Grupo de entrada para unirse a una sala -->
        <div class="input-group mb-3">
            <input type="text" id="roomName" class="form-control" placeholder="Nombre de la sala">
            <button id="joinRoom" class="btn btn-primary">Unirse</button>
            <button id="leaveRoom" class="btn btn-danger">Salir</button>
        </div>

        <!-- Indicador de sala actual -->
        <div class="alert alert-info" id="currentRoomInfo" style="display: none;">
            <strong>Sala actual:</strong> <span id="currentRoomName">Ninguna</span>
            
            <!-- Lista de usuarios conectados en la sala -->
            <div class="mt-2">
                <strong>Usuarios conectados:</strong>
                <ul id="usersList" class="mb-0">
                    <!-- Los usuarios se agregan din√°micamente con JavaScript -->
                </ul>
            </div>
            
            <!-- Indicador de "est√° escribiendo..." -->
            <div id="typingIndicator" class="mt-2 text-muted" style="display: none; font-style: italic;">
                <!-- Se muestra din√°micamente cuando alguien est√° escribiendo -->
            </div>
        </div>

        <!-- Campo para mostrar mensajes -->
        <div class="card">
            <div class="card-body">
                <ul id="messages" class="list-group mb-3" style="height: 300px; overflow-y: auto;"></ul>
                <div class="input-group">
                    <!-- Bot√≥n para seleccionar emojis -->
                    <button id="emojiBtn" class="btn btn-outline-secondary" type="button">üëç</button>
                    
                    <!-- Bot√≥n para seleccionar im√°genes -->
                    <button id="imageBtn" class="btn btn-outline-secondary" type="button">üñºÔ∏è</button>
                    
                    <!-- Bot√≥n para tomar foto con la c√°mara -->
                    <button id="cameraBtn" class="btn btn-outline-secondary" type="button">üì∏</button>
                    
                    <!-- Bot√≥n para grabar audio -->
                    <button id="audioBtn" class="btn btn-outline-secondary" type="button">üé§</button>
                    
                    <!-- Bot√≥n para grabar video -->
                    <button id="videoBtn" class="btn btn-outline-secondary" type="button">üé•</button>
                    
                    <!-- Input de texto para escribir mensajes -->
                    <input type="text" id="myMessage" class="form-control" placeholder="Escribe tu mensaje...">
                    
                    <!-- Bot√≥n para enviar mensaje -->
                    <button id="send" class="btn btn-primary">Enviar</button>
                </div>
                
                <!-- Input oculto para seleccionar archivos de imagen -->
                <!-- Se activa cuando el usuario hace clic en el bot√≥n üñºÔ∏è -->
                <input type="file" id="imageInput" accept="image/*" style="display: none;">
                
                <!-- Modal para captura de foto con c√°mara -->
                <div id="cameraModal" class="card mt-2" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 2000; width: 90%; max-width: 640px;">
                    <div class="card-body">
                        <h5>Capturar Foto</h5>
                        <video id="cameraStream" autoplay style="width: 100%; max-height: 400px; background: #000;"></video>
                        <canvas id="cameraCanvas" style="display: none;"></canvas>
                        <div class="mt-2">
                            <button id="capturePhoto" class="btn btn-success">üì∏ Capturar</button>
                            <button id="closeCameraModal" class="btn btn-secondary">Cerrar</button>
                        </div>
                    </div>
                </div>
                
                <!-- Controles de grabaci√≥n de audio -->
                <div id="audioControls" class="alert alert-warning mt-2" style="display: none;">
                    <strong>üé§ Grabando audio...</strong>
                    <button id="stopAudio" class="btn btn-danger btn-sm ms-2">‚èπ Detener</button>
                    <button id="cancelAudio" class="btn btn-secondary btn-sm ms-2"> Cancelar</button>
                </div>
                
                <!-- Controles de grabaci√≥n de video -->
                <div id="videoControls" class="alert alert-danger mt-2" style="display: none;">
                    <strong>üé• Grabando video...</strong>
                    <video id="videoPreview" autoplay muted style="width: 100%; max-width: 320px; margin-top: 10px; background: #000;"></video>
                    <div class="mt-2">
                        <button id="stopVideo" class="btn btn-danger btn-sm">‚èπ Detener</button>
                        <button id="cancelVideo" class="btn btn-secondary btn-sm ms-2"> Cancelar</button>
                    </div>
                </div>
                
                <!-- Panel de emojis -->
                <div id="emojiPicker" class="card mt-2" style="display: none; position: absolute; z-index: 1000; max-width: 320px;">
                    <div class="card-body">
                        <div id="emojiList" style="display: flex; flex-wrap: wrap; gap: 5px;">
                            <!-- Los emojis se generan din√°micamente con JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Se importa una librer√≠a SocketIO para JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.8.1/socket.io.js"></script>

    <!-- Se importa jQuery para facilitar la manipulaci√≥n del DOM -->
    <script src="https://code.jquery.com/jquery-4.0.0.min.js" integrity="sha256-OaVG6prZf4v69dPg6PhVattBXkcOWQB62pdZ3ORyrao=" crossorigin="anonymous"></script>

    <script>
        // Se crea una conexi√≥n con el servidor
        const socket = io({
            reconnection: true,  // Habilita la reconexi√≥n autom√°tica
            reconnectionAttempts: 5,  // N√∫mero de intentos de reconexi√≥n
            reconnectionDelay: 1000,  // Tiempo entre intentos en milisegundos
        }); 

        let username = '';  // Variable para almacenar el nombre de usuario
        let currentRoom = null;  // Variable para almacenar la sala actual
        let typingTimeout = null;  // Temporizador para el indicador de "escribiendo..."
        
        // Variables para manejo de captura de medios
        let mediaRecorder = null;  // Grabador de audio/video
        let recordedChunks = [];  // Fragmentos de audio/video grabados
        let cameraStream = null;  // Stream de la c√°mara para fotos
        let videoStream = null;  // Stream de video para grabaci√≥n

        // Lista de emojis disponibles en el selector
        const emojis = ['üòä', 'üòÇ', '‚ù§Ô∏è', 'üëç', 'üî•', 'üéâ', 'üòç', 'üöÄ', 'üíØ', 'ü§î', 'üòé', 'ü•≥', 'üò¢', 'üò≠', 'üò°', 'üí™', 'üôè', '‚ú®'];

        // Generar botones de emojis din√°micamente
        emojis.forEach(emoji => {
            $('#emojiList').append(`<button class="btn btn-light emoji-item" style="font-size: 1.5em;">${emoji}</button>`);
        });

        // Funci√≥n para formatear el timestamp (marca de tiempo) de manera legible
        // Convierte "2026-02-13T14:30:45.123456" a "14:30:45"
        function formatTimestamp(isoString) {
            const date = new Date(isoString);  // Crea un objeto Date desde el string ISO
            const hours = date.getHours().toString().padStart(2, '0');  // Obtiene las horas (formato 24h)
            const minutes = date.getMinutes().toString().padStart(2, '0');  // Obtiene los minutos
            const seconds = date.getSeconds().toString().padStart(2, '0');  // Obtiene los segundos
            return `${hours}:${minutes}:${seconds}`;  // Retorna en formato HH:MM:SS
        }

        // Funci√≥n para detectar si un texto es solo un emoji
        function isEmoji(str) {
            // Regex para detectar emojis
            const emojiRegex = /^(\p{Emoji_Presentation}|\p{Emoji}\uFE0F|\p{Emoji_Modifier_Base})+$/u;
            return emojiRegex.test(str.trim());
        }

        // Evento para establecer el nombre de usuario
        $('#setUsername').on('click', function() {
            const inputUsername = $('#username').val().trim();
            if (inputUsername.length > 0) {
                username = inputUsername;
                $('#username').prop('disabled', true);
                $('#setUsername').prop('disabled', true);
                alert(`Nombre de usuario establecido: ${username}`);
            } else {
                alert("El nombre de usuario no puede estar vac√≠o.");
            }
        });

        // Evento para establecer el nombre de usuario al presionar Enter
        $('#username').on('keypress', function(e) {
            if (e.key === 'Enter') {
                $('#setUsername').click();
            }
        });

        // Evento para unirse a una sala
        $('#joinRoom').on('click', function() {
            const roomName = $('#roomName').val().trim();
            
            // Validaciones
            if (!username) {
                alert("Debes establecer un nombre de usuario antes de unirte a una sala.");
                return;
            }
            if (roomName.length === 0) {
                alert("El nombre de la sala no puede estar vac√≠o.");
                return;
            }
            if (currentRoom) {
                alert("Ya est√°s en una sala. Sal primero antes de unirte a otra.");
                return;
            }

            // Guarda la sala actual
            currentRoom = roomName;
            
            // Emite el evento al servidor
            socket.emit("join_room", { room: roomName, username });
            
            // Actualiza la interfaz
            $('#currentRoomInfo').show();
            $('#currentRoomName').text(roomName);
            $('#messages').append(`<li class="list-group-item text-success">Te has unido a la sala: ${roomName}</li>`);
            $('#messages').scrollTop($('#messages')[0].scrollHeight);
        });

        // Evento para salir de una sala
        $('#leaveRoom').on('click', function() {
            if (!currentRoom) {
                alert("No est√°s en ninguna sala.");
                return;
            }

            // Emite el evento al servidor
            socket.emit("leave_room", { room: currentRoom, username });
            
            // Actualiza la interfaz
            $('#messages').append(`<li class="list-group-item text-warning">Has salido de la sala: ${currentRoom}</li>`);
            $('#messages').scrollTop($('#messages')[0].scrollHeight);
            currentRoom = null;
            $('#currentRoomInfo').hide();
            $('#usersList').empty();
        });

        // Mostrar/ocultar el panel de emojis
        $('#emojiBtn').on('click', function() {
            $('#emojiPicker').toggle();
        });

        // Evento para abrir el selector de im√°genes
        $('#imageBtn').on('click', function() {
            $('#imageInput').click();
        });

        // Evento cuando el usuario selecciona una imagen
        $('#imageInput').on('change', function(event) {
            const file = event.target.files[0];
            
            // Validaciones
            if (!file) return;
            if (!file.type.startsWith('image/')) {
                alert("Por favor selecciona un archivo de imagen v√°lido.");
                return;
            }
            const maxSize = 5 * 1024 * 1024; // 5MB
            if (file.size > maxSize) {
                alert("La imagen es demasiado grande. M√°ximo 5MB.");
                return;
            }

            // FileReader para convertir la imagen a base64
            const reader = new FileReader();
            reader.onload = function(e) {
                const base64Image = e.target.result;
                socket.emit("message", { 
                    username,
                    type: "image",
                    content: base64Image,
                    room: currentRoom
                });
            };
            reader.readAsDataURL(file);
            $('#imageInput').val('');
        });

        // ===== FUNCIONES PARA CAPTURA DE FOTO CON C√ÅMARA =====
        
        // Abrir modal de c√°mara para tomar foto
        $('#cameraBtn').on('click', async function() {
            if (!username || !currentRoom) {
                alert("Debes establecer un usuario y unirte a una sala primero.");
                return;
            }
            
            try {
                // Solicita acceso a la c√°mara (video sin audio)
                cameraStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: 1280, height: 720 },  // Resoluci√≥n HD
                    audio: false 
                });
                
                // Conecta el stream al elemento video
                $('#cameraStream')[0].srcObject = cameraStream;
                $('#cameraModal').show();
            } catch (err) {
                console.error('Error al acceder a la c√°mara:', err);
                alert('No se pudo acceder a la c√°mara. Verifica los permisos.');
            }
        });
        
        // Capturar foto desde el stream de video
        $('#capturePhoto').on('click', function() {
            const video = $('#cameraStream')[0];
            const canvas = $('#cameraCanvas')[0];
            
            // Ajusta el tama√±o del canvas al tama√±o del video
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            // Dibuja el frame actual del video en el canvas
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // Convierte el canvas a base64 (JPEG con 85% calidad)
            const imageData = canvas.toDataURL('image/jpeg', 0.85);
            
            // Verifica el tama√±o (l√≠mite 5MB)
            const sizeInMB = (imageData.length * 3/4) / (1024 * 1024);
            if (sizeInMB > 5) {
                alert('La foto es demasiado grande. Intenta con menor resoluci√≥n.');
                return;
            }
            
            // Env√≠a la foto al servidor
            socket.emit('message', {
                username,
                type: 'image',
                content: imageData,
                room: currentRoom
            });
            
            // Cierra el modal y detiene la c√°mara
            closeCameraModal();
        });
        
        // Cerrar modal de c√°mara
        $('#closeCameraModal').on('click', closeCameraModal);
        
        function closeCameraModal() {
            if (cameraStream) {
                // Detiene todos los tracks del stream
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            $('#cameraModal').hide();
        }
        
        // ===== FUNCIONES PARA GRABACI√ìN DE AUDIO =====
        
        // Iniciar grabaci√≥n de audio
        $('#audioBtn').on('click', async function() {
            if (!username || !currentRoom) {
                alert("Debes establecer un usuario y unirte a una sala primero.");
                return;
            }
            
            try {
                // Solicita acceso al micr√≥fono
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                
                // Crea el grabador con formato webm
                mediaRecorder = new MediaRecorder(stream, { mimeType: 'audio/webm' });
                recordedChunks = [];
                
                // Cuando hay datos disponibles, los almacena
                mediaRecorder.ondataavailable = function(event) {
                    if (event.data.size > 0) {
                        recordedChunks.push(event.data);
                    }
                };
                
                // Cuando termina la grabaci√≥n, procesa el audio
                mediaRecorder.onstop = function() {
                    // Crea un Blob con todos los fragmentos grabados
                    const audioBlob = new Blob(recordedChunks, { type: 'audio/webm' });
                    
                    // Verifica el tama√±o (l√≠mite 10MB para audio)
                    if (audioBlob.size > 10 * 1024 * 1024) {
                        alert('El audio es demasiado largo (m√°x 10MB).');
                        return;
                    }
                    
                    // Convierte el Blob a base64
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        socket.emit('message', {
                            username,
                            type: 'audio',
                            content: e.target.result,
                            room: currentRoom
                        });
                    };
                    reader.readAsDataURL(audioBlob);
                    
                    // Detiene el stream
                    stream.getTracks().forEach(track => track.stop());
                };
                
                // Inicia la grabaci√≥n
                mediaRecorder.start();
                $('#audioControls').show();
                
            } catch (err) {
                console.error('Error al acceder al micr√≥fono:', err);
                alert('No se pudo acceder al micr√≥fono. Verifica los permisos.');
            }
        });
        
        // Detener grabaci√≥n de audio
        $('#stopAudio').on('click', function() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                $('#audioControls').hide();
            }
        });
        
        // Cancelar grabaci√≥n de audio
        $('#cancelAudio').on('click', function() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                recordedChunks = [];  // Descarta los datos
                $('#audioControls').hide();
            }
        });
        
        // ===== FUNCIONES PARA GRABACI√ìN DE VIDEO =====
        
        // Iniciar grabaci√≥n de video
        $('#videoBtn').on('click', async function() {
            if (!username || !currentRoom) {
                alert("Debes establecer un usuario y unirte a una sala primero.");
                return;
            }
            
            try {
                // Solicita acceso a c√°mara y micr√≥fono
                videoStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: 640, height: 480 },  // Resoluci√≥n reducida para menor tama√±o
                    audio: true 
                });
                
                // Muestra preview del video
                $('#videoPreview')[0].srcObject = videoStream;
                
                // Crea el grabador
                mediaRecorder = new MediaRecorder(videoStream, { mimeType: 'video/webm' });
                recordedChunks = [];
                
                // Almacena los datos
                mediaRecorder.ondataavailable = function(event) {
                    if (event.data.size > 0) {
                        recordedChunks.push(event.data);
                    }
                };
                
                // Procesa el video al terminar
                mediaRecorder.onstop = function() {
                    const videoBlob = new Blob(recordedChunks, { type: 'video/webm' });
                    
                    // Verifica el tama√±o (l√≠mite 20MB para video)
                    if (videoBlob.size > 20 * 1024 * 1024) {
                        alert('El video es demasiado largo (m√°x 20MB). Intenta grabaciones m√°s cortas.');
                        videoStream.getTracks().forEach(track => track.stop());
                        return;
                    }
                    
                    // Convierte a base64
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        socket.emit('message', {
                            username,
                            type: 'video',
                            content: e.target.result,
                            room: currentRoom
                        });
                    };
                    reader.readAsDataURL(videoBlob);
                    
                    // Detiene el stream
                    videoStream.getTracks().forEach(track => track.stop());
                };
                
                // Inicia la grabaci√≥n
                mediaRecorder.start();
                $('#videoControls').show();
                
            } catch (err) {
                console.error('Error al acceder a c√°mara/micr√≥fono:', err);
                alert('No se pudo acceder a la c√°mara/micr√≥fono. Verifica los permisos.');
            }
        });
        
        // Detener grabaci√≥n de video
        $('#stopVideo').on('click', function() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                $('#videoControls').hide();
            }
        });
        
        // Cancelar grabaci√≥n de video
        $('#cancelVideo').on('click', function() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                recordedChunks = [];  // Descarta los datos
                $('#videoControls').hide();
                if (videoStream) {
                    videoStream.getTracks().forEach(track => track.stop());
                }
            }
        });
        
        // Insertar emoji al hacer clic
        $(document).on('click', '.emoji-item', function() {
            const emoji = $(this).text();
            $('#myMessage').val($('#myMessage').val() + emoji);
            $('#emojiPicker').hide();
            $('#myMessage').focus();
        });

        // Cerrar el panel de emojis al hacer clic fuera
        $(document).on('click', function(e) {
            if (!$(e.target).closest('#emojiBtn, #emojiPicker').length) {
                $('#emojiPicker').hide();
            }
        });

        // El navegador escucha los mensajes que el servidor env√≠a
        socket.on("message", function(msg) {
            if (typeof msg === 'string') {
                // Mensaje de sistema
                $('#messages').append(`<li class="list-group-item text-muted">${msg}</li>`);
            } else {
                // Mensaje de usuario
                const time = formatTimestamp(msg.timestamp);
                
                if (msg.type === "emoji") {
                    $('#messages').append(`
                        <li class="list-group-item">
                            <small class="text-muted">[${time}]</small>
                            <strong>${msg.username}:</strong> 
                            <span style="font-size: 3em;">${msg.content}</span>
                        </li>
                    `);
                } else if (msg.type === "image") {
                    $('#messages').append(`
                        <li class="list-group-item">
                            <small class="text-muted">[${time}]</small>
                            <strong>${msg.username}:</strong><br>
                            <img src="${msg.content}" style="max-width: 100%; max-height: 300px; border-radius: 8px; margin-top: 5px;" alt="Imagen">
                        </li>
                    `);
                } else if (msg.type === "audio") {
                    // Mensaje de audio con reproductor HTML5
                    $('#messages').append(`
                        <li class="list-group-item">
                            <small class="text-muted">[${time}]</small>
                            <strong>${msg.username}:</strong> üé§ Audio<br>
                            <audio controls style="max-width: 100%; margin-top: 5px;">
                                <source src="${msg.content}" type="audio/webm">
                                Tu navegador no soporta audio HTML5.
                            </audio>
                        </li>
                    `);
                } else if (msg.type === "video") {
                    // Mensaje de video con reproductor HTML5
                    $('#messages').append(`
                        <li class="list-group-item">
                            <small class="text-muted">[${time}]</small>
                            <strong>${msg.username}:</strong> üé• Video<br>
                            <video controls style="max-width: 100%; max-height: 400px; border-radius: 8px; margin-top: 5px;">
                                <source src="${msg.content}" type="video/webm">
                                Tu navegador no soporta video HTML5.
                            </video>
                        </li>
                    `);
                } else {
                    $('#messages').append(`
                        <li class="list-group-item">
                            <small class="text-muted">[${time}]</small>
                            <strong>${msg.username}:</strong> ${msg.content}
                        </li>
                    `);
                }
            }
            $('#messages').scrollTop($('#messages')[0].scrollHeight);
        });

        // Evento cuando el usuario est√° escribiendo
        $('#myMessage').on('input', function() {
            if (currentRoom && username) {
                socket.emit('typing', {
                    username: username,
                    room: currentRoom,
                    is_typing: true
                });
                
                clearTimeout(typingTimeout);
                typingTimeout = setTimeout(function() {
                    socket.emit('typing', {
                        username: username,
                        room: currentRoom,
                        is_typing: false
                    });
                }, 2000);
            }
        });

        // Evento para enviar mensajes al presionar Enter
        $('#myMessage').on('keypress', function(e) {
            if (e.key === 'Enter') {
                $('#send').click();
                if (currentRoom && username) {
                    clearTimeout(typingTimeout);
                    socket.emit('typing', {
                        username: username,
                        room: currentRoom,
                        is_typing: false
                    });
                }
            }
        });

        // Evento para enviar mensajes
        $('#send').on('click', function() { 
            const message = $('#myMessage').val().trim();
            
            // Validaciones
            if (!username) {
                alert("Debes establecer un nombre de usuario antes de enviar mensajes.");
                return;
            }
            if (!currentRoom) {
                alert("Debes unirte a una sala antes de enviar mensajes.");
                return;
            }
            if (message.length === 0) {
                alert("El mensaje no puede estar vac√≠o.");
                return;
            }
            if (message.length > 1000) {
                alert("El mensaje no puede exceder los 1000 caracteres.");
                return;
            }

            // Notifica que dej√≥ de escribir
            clearTimeout(typingTimeout);
            socket.emit('typing', {
                username: username,
                room: currentRoom,
                is_typing: false
            });

            // Env√≠a el mensaje
            if (isEmoji(message)) {
                socket.emit("message", { 
                    username, 
                    type: "emoji", 
                    content: message,
                    room: currentRoom
                });
            } else {
                socket.emit("message", { 
                    username, 
                    type: "text", 
                    content: message,
                    room: currentRoom
                });
            }
            
            $('#myMessage').val('');
        });

        // Evento para recibir actualizaciones de la lista de usuarios
        socket.on('update_user_list', function(data) {
            const users = data.users;
            $('#usersList').empty();
            users.forEach(function(user) {
                $('#usersList').append(`<li>${user}</li>`);
            });
        });

        // Evento para mostrar el indicador "est√° escribiendo..."
        socket.on('user_typing', function(data) {
            const typingUser = data.username;
            const isTyping = data.is_typing;
            
            if (isTyping) {
                $('#typingIndicator').text(`${typingUser} est√° escribiendo...`).show();
            } else {
                $('#typingIndicator').hide();
            }
        });

        // Manejo de errores de conexi√≥n
        socket.on("connect_error", () => {
            alert("No se pudo conectar al servidor. Verifica tu conexi√≥n.");
        });

        socket.on("disconnect", () => {
            $('#messages').append(`<li class="list-group-item text-danger">Te has desconectado. Intentando reconectar...</li>`);
            $('#messages').scrollTop($('#messages')[0].scrollHeight);
        });

        socket.on("connect", () => {
            $('#messages').append(`<li class="list-group-item text-success">Conectado al servidor.</li>`);
            $('#messages').scrollTop($('#messages')[0].scrollHeight);
        });
    </script> 
</body>
</html>
