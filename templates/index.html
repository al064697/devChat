<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>devChat - Real-time Developer Chat</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="../static/css/style.css" rel="stylesheet">
</head>
<body>
    <div class="app-header">
        <div class="container">
            <h1 class="text-center app-title">‚ö° devChat</h1>
            <p class="text-center app-subtitle">Real-time communication for developers</p>
        </div>
    </div>

    <div class="container mt-4">
        <!-- Panel de control de usuario y sala -->
        <div class="control-panel">
            <!-- Grupo de entrada para el nombre de usuario -->
            <div class="input-group mb-3">
                <input type="text" id="username" class="form-control" placeholder="Tu nombre de usuario">
                <button id="setUsername" class="btn btn-success">Establecer</button>
            </div>

            <!-- Grupo de entrada para unirse a una sala -->
            <div class="input-group">
                <input type="text" id="roomName" class="form-control" placeholder="Nombre de la sala">
                <button id="joinRoom" class="btn btn-primary">Unirse</button>
                <button id="leaveRoom" class="btn btn-danger">Salir</button>
            </div>
        </div>

        <!-- Indicador de sala actual -->
        <div class="room-info" id="currentRoomInfo" style="display: none;">
            <strong>Sala actual:</strong> <span id="currentRoomName">Ninguna</span>
            
            <!-- Lista de usuarios conectados en la sala -->
            <div class="mt-2">
                <strong>Usuarios conectados:</strong>
                <ul id="usersList" class="mb-0">
                    <!-- Los usuarios se agregan din√°micamente con JavaScript -->
                </ul>
            </div>
            
            <!-- Indicador de "est√° escribiendo..." -->
            <div id="typingIndicator" class="mt-2 text-muted" style="display: none; font-style: italic;">
                <!-- Se muestra din√°micamente cuando alguien est√° escribiendo -->
            </div>
        </div>

        <!-- Campo para mostrar mensajes -->
        <div class="chat-container">
            <div class="card-body">
                <ul id="messages" class="list-group mb-3"></ul>
                <div class="message-controls">
                    <div class="input-group">
                    <!-- Bot√≥n para seleccionar emojis -->
                    <button id="emojiBtn" class="btn btn-outline-secondary" type="button">üëç</button>
                    
                    <!-- Bot√≥n para seleccionar im√°genes -->
                    <button id="imageBtn" class="btn btn-outline-secondary" type="button">üñºÔ∏è</button>
                    
                    <!-- Bot√≥n para tomar foto con la c√°mara -->
                    <button id="cameraBtn" class="btn btn-outline-secondary" type="button">üì∏</button>
                    
                    <!-- Bot√≥n para grabar audio -->
                    <button id="audioBtn" class="btn btn-outline-secondary" type="button">üé§</button>
                    
                    <!-- Bot√≥n para grabar video -->
                    <button id="videoBtn" class="btn btn-outline-secondary" type="button">üé•</button>
                    
                    <!-- Input de texto para escribir mensajes -->
                    <input type="text" id="myMessage" class="form-control" placeholder="Escribe tu mensaje...">
                    
                    <!-- Bot√≥n para enviar mensaje -->
                    <button id="send" class="btn btn-primary">Enviar</button>
                </div>
                </div>
                
                <!-- Input oculto para seleccionar archivos de imagen -->
                <!-- Se activa cuando el usuario hace clic en el bot√≥n üñºÔ∏è -->
                <input type="file" id="imageInput" accept="image/*" style="display: none;">
                
                <!-- Modal para captura de foto con c√°mara -->
                <div id="cameraModal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 2000; width: 90%; max-width: 640px;">
                    <div class="card-body">
                        <h5>üì∏ Capturar Foto</h5>
                        <video id="cameraStream" autoplay style="width: 100%; max-height: 400px;"></video>
                        <canvas id="cameraCanvas" style="display: none;"></canvas>
                        <div class="mt-3">
                            <button id="capturePhoto" class="btn btn-success me-2">üì∏ Capturar</button>
                            <button id="closeCameraModal" class="btn btn-secondary">‚úñ Cerrar</button>
                        </div>
                    </div>
                </div>
                
                <!-- Controles de grabaci√≥n de audio -->
                <div id="audioControls" class="mt-2" style="display: none;">
                    <strong>üé§ Grabando audio...</strong>
                    <button id="stopAudio" class="btn btn-danger btn-sm ms-2">‚èπ Detener</button>
                    <button id="cancelAudio" class="btn btn-secondary btn-sm ms-2">‚úñ Cancelar</button>
                </div>
                
                <!-- Controles de grabaci√≥n de video -->
                <div id="videoControls" class="mt-2" style="display: none;">
                    <strong>üé• Grabando video...</strong>
                    <video id="videoPreview" autoplay muted style="width: 100%; max-width: 320px; margin-top: 10px;"></video>
                    <div class="mt-2">
                        <button id="stopVideo" class="btn btn-danger btn-sm">‚èπ Detener</button>
                        <button id="cancelVideo" class="btn btn-secondary btn-sm ms-2">‚úñ Cancelar</button>
                    </div>
                </div>
                
                <!-- Panel de emojis -->
                <div id="emojiPicker" style="display: none; position: absolute; z-index: 9999; max-width: 320px;">
                    <div class="card-body">
                        <div id="emojiList" style="display: flex; flex-wrap: wrap; gap: 5px;">
                            <!-- Los emojis se generan din√°micamente con JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Se importa una librer√≠a SocketIO para JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.8.1/socket.io.js"></script>

    <!-- Se importa jQuery para facilitar la manipulaci√≥n del DOM -->
    <script src="https://code.jquery.com/jquery-4.0.0.min.js" integrity="sha256-OaVG6prZf4v69dPg6PhVattBXkcOWQB62pdZ3ORyrao=" crossorigin="anonymous"></script>

    <!-- L√≥gica del cliente -->
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script> 
</body>
</html>